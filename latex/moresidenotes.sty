%%%
%%% moresidenotes.sty -- Side notes
%%%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{moresidenotes}
[2018/04/30 Tufte-esque side notes and image commands for the argon classes]

% Backend for margin notes
\RequirePackage{marginnote}

% Fix overlapping margin notes which are in close proximity
\RequirePackage{marginfix}

% Command for typesetting the sidenote marker
\newcommand{\sidemark}[1]{#1.}

% Command for deciding justification for content in the margin
\newcommand{\argonflush}{
  \ifthenelse{\boolean{@argon@twoside}}{%
    \checkoddpage
    \ifoddpage%
      \RaggedRight
    \else
      \RaggedLeft
    \fi
  }{
    \RaggedRight
  }
}

% Floating margin notes (for automatic alignment)
\newcommand{\myside}[1]{%
  \footnotemark%
  \ignorespaces%
  \marginpar{%
    \sidemark{\thefootnote}%
    \argonflush
    \footnotesize #1
  }
  \unskip%
}

% Margin figure caption settings
\captionsetup[marginfigure]{
  font={footnotesize}
}

% Custom margin figure
\newcommand{\myfig}[2]{
  \begin{marginfigure}
    \ifthenelse{\boolean{@argon@twoside}}{%
      \checkoddpage
      \ifoddpage%
      \captionsetup{type=figure,%
        options=marginfigure,%
        justification=RaggedRight,%
        singlelinecheck=false}
      \RaggedRight
      \else
      \captionsetup{type=figure,%
        options=marginfigure,%
        justification=raggedleft,%
        singlelinecheck=false}
      \RaggedLeft
      \fi
    }{
      \captionsetup{type=figure,%
        options=marginfigure,%
        justification=RaggedRight,%
        singlelinecheck=false}
      \RaggedRight
    }
    \includegraphics[width=\linewidth]{#1}
    \vspace{-15pt}
    \label{#1}
    \caption*{#2}
  \end{marginfigure}
}

